{"version":3,"sources":["index.js"],"names":["path","datx","_","ipDatabaseUri","resolve","__dirname","DatabaseClient","City","isIp","ip","test","ip2Locate","country","province","city","res","findSync","get"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,IAAP,MAAiB,MAAjB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,CAAP,MAAc,QAAd;AAEA,IAAIC,aAAa,GAAGH,IAAI,CAACI,OAAL,CAAaC,SAAb,EAAwB,oCAAxB,CAApB;AAEA,IAAIC,cAAc,GAAG,IAAIL,IAAI,CAACM,IAAT,CAAcJ,aAAd,CAArB;;AAEA,SAASK,IAAT,CAAeC,EAAf,EAAmB;AACjB,SAAO,sDAAsDC,IAAtD,CAA2DD,EAA3D,CAAP;AACD;;AAED,SAASE,SAAT,CAAoBF,EAApB,EAAwB;AACtB,MAAIG,OAAO,GAAG,EAAd;AACA,MAAIC,QAAQ,GAAG,EAAf;AACA,MAAIC,IAAI,GAAG,EAAX;;AACA,MAAIN,IAAI,CAACC,EAAD,CAAJ,KAAa,KAAjB,EAAwB;AACtB,WAAO;AACLG,MAAAA,OADK;AACI;AACTC,MAAAA,QAFK;AAEK;AACVC,MAAAA,IAHK,CAGA;;AAHA,KAAP;AAKD;;AACD,MAAIC,GAAG,GAAGT,cAAc,CAACU,QAAf,CAAwBP,EAAxB,CAAV;AACAG,EAAAA,OAAO,GAAGV,CAAC,CAACe,GAAF,CAAMF,GAAN,EAAW,CAAC,CAAD,CAAX,EAAgB,EAAhB,CAAV;AACAF,EAAAA,QAAQ,GAAGX,CAAC,CAACe,GAAF,CAAMF,GAAN,EAAW,CAAC,CAAD,CAAX,EAAgB,EAAhB,CAAX;AACAD,EAAAA,IAAI,GAAGZ,CAAC,CAACe,GAAF,CAAMF,GAAN,EAAW,CAAC,CAAD,CAAX,EAAgB,EAAhB,CAAP;AACA,SAAO;AACLH,IAAAA,OADK;AACI;AACTC,IAAAA,QAFK;AAEK;AACVC,IAAAA,IAHK,CAGA;;AAHA,GAAP;AAKD;;AAED,eAAe;AACbH,EAAAA;AADa,CAAf","sourcesContent":["// 引入ipip-datx模块\n// 基于ipip.net提供的地址库数据\n// 最后更新时间: 2018-09-19\nimport path from 'path'\nimport datx from 'ipip-datx'\nimport _ from 'lodash'\n\nlet ipDatabaseUri = path.resolve(__dirname, './ip2locate_ipip.net_20180910.datx')\n\nlet DatabaseClient = new datx.City(ipDatabaseUri)\n\nfunction isIp (ip) {\n  return /^(([1-9]?\\d|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(?!$)|$)){4}$/.test(ip)\n}\n\nfunction ip2Locate (ip) {\n  let country = ''\n  let province = ''\n  let city = ''\n  if (isIp(ip) === false) {\n    return {\n      country, //  国家\n      province, //  省\n      city //  市\n    }\n  }\n  let res = DatabaseClient.findSync(ip)\n  country = _.get(res, [0], '')\n  province = _.get(res, [1], '')\n  city = _.get(res, [2], '')\n  return {\n    country, //  国家\n    province, //  省\n    city //  市\n  }\n}\n\nexport default {\n  ip2Locate\n}\n"],"file":"index.js"}