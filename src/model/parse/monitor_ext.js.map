{"version":3,"sources":["monitor_ext.js"],"names":["moment","Knex","Logger","BASE_TABLE_NAME","TABLE_COLUMN","getTableName","projectId","visitAt","visitAtMonth","unix","format","getRecordListByIdList","createAt","idList","tableName","rawRecordList","select","from","whereIn","catch","e","warn"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,IAAP,MAAiB,qBAAjB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AAEA,MAAMC,eAAe,GAAG,iBAAxB;AAEA,MAAMC,YAAY,GAAG,CAClB,IADkB,EAElB,UAFkB,EAGlB,aAHkB,EAIlB,aAJkB,CAArB;AAOA;AACA;AACA;AACA;;AACA,SAASC,YAAT,CAAuBC,SAAvB,EAAkCC,OAAlC,EAA2C;AACzC,MAAIC,YAAY,GAAGR,MAAM,CAACS,IAAP,CAAYF,OAAZ,EAAqBG,MAArB,CAA4B,QAA5B,CAAnB;AACA,SAAQ,GAAEP,eAAgB,IAAGG,SAAU,IAAGE,YAAa,EAAvD;AACD;;AAED,eAAeG,qBAAf,CAAsCL,SAAtC,EAAiDM,QAAjD,EAA2DC,MAAM,GAAG,EAApE,EAAwE;AACtE,MAAIC,SAAS,GAAGT,YAAY,CAACC,SAAD,EAAYM,QAAZ,CAA5B;AACA,MAAIG,aAAa,GAAGd,IAAI,CACrBe,MADiB,CACVZ,YADU,EAEjBa,IAFiB,CAEZH,SAFY,EAGjBI,OAHiB,CAGT,IAHS,EAGHL,MAHG,EAIjBM,KAJiB,CAIXC,CAAC,IAAI;AACVlB,IAAAA,MAAM,CAACmB,IAAP,CAAY,+BAAZ,EAA6CD,CAA7C;AACA,WAAO,EAAP;AACD,GAPiB,CAApB;AAQA,SAAOL,aAAP;AACD;;AAED,eAAe;AACbV,EAAAA,YADa;AAEbM,EAAAA;AAFa,CAAf","sourcesContent":["import moment from 'moment'\nimport Knex from '~/src/library/mysql'\nimport Logger from '~/src/library/logger'\n\nconst BASE_TABLE_NAME = 't_o_monitor_ext'\n\nconst TABLE_COLUMN = [\n  `id`,\n  `ext_json`,\n  `create_time`,\n  `update_time`\n]\n\n/**\n * @param {*} projectId\n * @param {*} visitAt\n */\nfunction getTableName (projectId, visitAt) {\n  let visitAtMonth = moment.unix(visitAt).format('YYYYMM')\n  return `${BASE_TABLE_NAME}_${projectId}_${visitAtMonth}`\n}\n\nasync function getRecordListByIdList (projectId, createAt, idList = []) {\n  let tableName = getTableName(projectId, createAt)\n  let rawRecordList = Knex\n    .select(TABLE_COLUMN)\n    .from(tableName)\n    .whereIn('id', idList)\n    .catch(e => {\n      Logger.warn('getRecordListByIdList查询失败 => ', e)\n      return []\n    })\n  return rawRecordList\n}\n\nexport default {\n  getTableName,\n  getRecordListByIdList\n}\n"],"file":"monitor_ext.js"}